<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>清华大学学习路径 - 动态加载版</title>
  <style>
    body {
      font-family: 'Microsoft YaHei', '微软雅黑', sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }
    h1 {
      color: #0066cc;
      text-align: center;
    }
    h2 {
      color: #0066cc;
      border-bottom: 1px solid #ddd;
      padding-bottom: 5px;
    }
    h3 {
      margin-top: 15px;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }
    .stage-section {
      margin-bottom: 40px;
    }
    .month {
      flex: 1 0 100%;
      margin-bottom: 30px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background-color: #f9f9f9;
    }
    .month h3 {
      color: #0066cc;
      margin-top: 0;
    }
    .goals {
      color: #006633;
    }
    .tasks {
      color: #990000;
    }
    .tips {
      color: #663399;
      font-style: italic;
      margin-top: 15px;
      padding: 10px;
      background-color: #f0f0ff;
      border-radius: 5px;
    }
    .progress-bar {
      height: 20px;
      background-color: #e0e0e0;
      border-radius: 10px;
      margin-top: 15px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background-color: #0066cc;
      border-radius: 10px;
    }
    .navigation {
      position: sticky;
      top: 10px;
      background-color: white;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      margin-bottom: 20px;
      z-index: 100;
    }
    .navigation select {
      width: 100%;
      padding: 5px;
    }
    .back-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #0066cc;
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 20px;
      cursor: pointer;
    }
    .loading {
      text-align: center;
      padding: 20px;
      font-style: italic;
      color: #666;
    }
    .error {
      color: #cc0000;
      padding: 15px;
      border: 1px solid #ffcccc;
      background-color: #fff0f0;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <h1>我的清华大学学习路径</h1>
  <p style="text-align: center;">从小学1年级到高考的132个月计划</p>
  
  <div class="navigation">
    <select id="stage-select" onchange="jumpToStage()">
      <option value="">选择学习阶段</option>
      <option value="primary1">小学1年级</option>
      <option value="primary2">小学2年级</option>
      <option value="primary3">小学3年级</option>
      <option value="primary4">小学4年级</option>
      <option value="primary5">小学5年级</option>
      <option value="primary6">小学6年级</option>
      <option value="middle1">初中1年级</option>
      <option value="middle2">初中2年级</option>
      <option value="middle3">初中3年级</option>
      <option value="high1">高中1年级</option>
      <option value="high2">高中2年级</option>
      <option value="high3">高中3年级</option>
    </select>
  </div>
  
  <!-- 小学1年级 -->
  <div id="primary1" class="stage-section">
    <h2>小学1年级</h2>
    <div id="primary1-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 小学2年级 -->
  <div id="primary2" class="stage-section">
    <h2>小学2年级</h2>
    <div id="primary2-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 小学3年级 -->
  <div id="primary3" class="stage-section">
    <h2>小学3年级</h2>
    <div id="primary3-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 小学4年级 -->
  <div id="primary4" class="stage-section">
    <h2>小学4年级</h2>
    <div id="primary4-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 小学5年级 -->
  <div id="primary5" class="stage-section">
    <h2>小学5年级</h2>
    <div id="primary5-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 小学6年级 -->
  <div id="primary6" class="stage-section">
    <h2>小学6年级</h2>
    <div id="primary6-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 初中1年级 -->
  <div id="middle1" class="stage-section">
    <h2>初中1年级</h2>
    <div id="middle1-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 初中2年级 -->
  <div id="middle2" class="stage-section">
    <h2>初中2年级</h2>
    <div id="middle2-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 初中3年级 -->
  <div id="middle3" class="stage-section">
    <h2>初中3年级</h2>
    <div id="middle3-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 高中1年级 -->
  <div id="high1" class="stage-section">
    <h2>高中1年级</h2>
    <div id="high1-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 高中2年级 -->
  <div id="high2" class="stage-section">
    <h2>高中2年级</h2>
    <div id="high2-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <!-- 高中3年级 -->
  <div id="high3" class="stage-section">
    <h2>高中3年级</h2>
    <div id="high3-content" class="container">
      <div class="loading">加载中，请稍候...</div>
    </div>
  </div>
  
  <p style="text-align: center; margin-top: 30px;">
    <a href="index.html">返回首页</a> | 
    <a href="https://github.com/bugkiwi/path-to-tsinghua">GitHub 代码库</a>
  </p>
  
  <button class="back-to-top" onclick="backToTop()" title="返回顶部">↑</button>
  
  <script>
    // 全局变量存储所有数据
    let primarySchoolYear1, primarySchoolYear2, primarySchoolYear3, primarySchoolYear4, 
        primarySchoolYear5, primarySchoolYear6, middleSchoolYear1, middleSchoolYear2, 
        middleSchoolYear3, highSchoolYear1, highSchoolYear2, highSchoolYear3;
    
    // 年级和数据变量的映射
    const gradeDataMapping = {
      'primary1': 'primarySchoolYear1',
      'primary2': 'primarySchoolYear2',
      'primary3': 'primarySchoolYear3',
      'primary4': 'primarySchoolYear4',
      'primary5': 'primarySchoolYear5',
      'primary6': 'primarySchoolYear6',
      'middle1': 'middleSchoolYear1',
      'middle2': 'middleSchoolYear2',
      'middle3': 'middleSchoolYear3',
      'high1': 'highSchoolYear1',
      'high2': 'highSchoolYear2',
      'high3': 'highSchoolYear3'
    };
    
    // 渲染月份内容
    function renderMonths(gradeId) {
      const container = document.getElementById(`${gradeId}-content`);
      container.innerHTML = '';
      
      // 获取对应的数据
      const data = window[gradeDataMapping[gradeId]];
      
      if (!data || !Array.isArray(data)) {
        container.innerHTML = `<div class="error">无法加载数据。请确保JavaScript文件正确加载。</div>`;
        return;
      }
      
      data.forEach(month => {
        const monthElement = document.createElement('div');
        monthElement.className = 'month';
        
        const progressPercent = Math.round(month.month / 144 * 100);
        
        monthElement.innerHTML = `
          <h3>第${month.month}个月：${month.title}</h3>
          <div class="goals">
            <h4>月度目标：</h4>
            <ul>
              ${month.goals.map(goal => `<li>${goal}</li>`).join('')}
            </ul>
          </div>
          <div class="tasks">
            <h4>本月任务：</h4>
            <ul>
              ${month.tasks.map(task => `<li>${task}</li>`).join('')}
            </ul>
          </div>
          <div class="tips">
            <p>小贴士：${month.tips}</p>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: ${progressPercent}%;"></div>
          </div>
          <div style="text-align: right; font-size: 0.8em; margin-top: 5px;">学习进度：${progressPercent}%</div>
        `;
        
        container.appendChild(monthElement);
      });
    }
    
    // 动态加载所有JS文件
    function loadAllScripts() {
      const scripts = [
        'months/primary_school_year1.js',
        'months/primary_school_year2.js',
        'months/primary_school_year3.js',
        'months/primary_school_year4.js',
        'months/primary_school_year5.js',
        'months/primary_school_year6.js',
        'months/middle_school_year1.js',
        'months/middle_school_year2.js',
        'months/middle_school_year3.js',
        'months/high_school_year1.js',
        'months/high_school_year2.js',
        'months/high_school_year3.js'
      ];
      
      // 使用Promise.all等待所有脚本加载完成
      const promises = scripts.map(script => {
        return new Promise((resolve, reject) => {
          const scriptElement = document.createElement('script');
          scriptElement.src = script;
          scriptElement.onload = resolve;
          scriptElement.onerror = reject;
          document.head.appendChild(scriptElement);
        });
      });
      
      // 所有脚本加载完成后，渲染所有年级的内容
      Promise.all(promises)
        .then(() => {
          // 渲染所有年级的内容
          Object.keys(gradeDataMapping).forEach(gradeId => {
            renderMonths(gradeId);
          });
        })
        .catch(error => {
          console.error('Failed to load scripts:', error);
          document.querySelectorAll('.container').forEach(container => {
            container.innerHTML = `<div class="error">加载脚本失败：${error.message}</div>`;
          });
        });
    }
    
    function jumpToStage() {
      const select = document.getElementById('stage-select');
      const stageId = select.value;
      if (stageId) {
        document.getElementById(stageId).scrollIntoView({ behavior: 'smooth' });
      }
    }
    
    function backToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    // 当页面加载时，加载所有脚本
    document.addEventListener('DOMContentLoaded', loadAllScripts);
  </script>
</body>
</html>